import generated.TableCanonicalizer;

import ru.icc.td.tabbyxl.DataLoader;
import ru.icc.td.tabbyxl.model.CTable;

import java.io.File;

class SpreadsheetDataConverter {

    public static void main(String[] args) throws Exception {
        String inputExcelFilePath = "D:\\Box Sync\\data\\tabbyxl\\illustrative_examples\\mvngen2019\\example1\\data\\tables.xlsx";
        File inputExcelFile = new File(inputExcelFilePath);

        DataLoader dataLoader = DataLoader.getInstance();
        dataLoader.loadWorkbook(inputExcelFile);

        for (int i = 0; i < dataLoader.numOfSheets(); i++) {
            dataLoader.goToSheet(i);

            while (true) {
                CTable table = dataLoader.nextTable();
                if (null == table) break;

                TableCanonicalizer.canonicalize(table);

                System.out.println(table.trace());
                table.toCanonicalForm().print();
            }
        }
    }
}